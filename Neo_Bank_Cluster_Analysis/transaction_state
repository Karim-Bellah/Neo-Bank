SELECT user_id,
  IFNULL(DECLINED, 0) AS DECLINED,
  IFNULL(COMPLETED, 0) AS COMPLETED,
  IFNULL(REVERTED, 0) AS REVERTED,
  IFNULL(FAILED, 0) AS FAILED,
  IFNULL(PENDING, 0) AS PENDING,
  IFNULL(CANCELLED, 0) AS CANCELLED
FROM `my-project-study-393315.neo_bank.cluster_test_transaction_state`
PIVOT (SUM(user_id_count) FOR transactions_state IN ('DECLINED', 'COMPLETED', 'REVERTED', 'FAILED', 'PENDING', 'CANCELLED'))
